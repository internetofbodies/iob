<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <meta
      name="description"
      content="Intente of Bodies Manage your connected devices and ensure they're providing accurate and up-to-date information about your health."
    />
    <meta
      name="keywords"
      content="Internet of Bodies Smart watch, Internet of Bodies Heart Rate Monitoring, Internet of Bodies Blood Pressure Monitoring, Internet of Bodies ECG Monitor, Internet of Bodies Sleep Monitor."
    />
    <meta name="author" content="Accountable Infrastructure" />
    <title>Internet of Bodies - Health Dashboard</title>

    <!--Favicon-->
    <link rel="icon" href="logo.png" type="image/png" />

    <!-- Organization Structured Data without Social Media -->
    <script type="application/ld+json">
      {
        "@context": "https://schema.org",
        "@type": "Organization",
        "name": "Accountable Infrastructure",
        "url": "https://internetofbodies.ai/",
        "logo": "https://internetofbodies.ai/logo.jpg"
      }
    </script>

    <!-- CSS -->
    <link rel="stylesheet" href="style.css" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.1/css/all.min.css"
      integrity="sha512-5Hs3dF2AEPkpNAR7UiOHba+lRSJNeM2ECkwxUIxC1Q/FLycGTbNapWXB4tP889k5T5Ju8fs4b1P5z/iB4nMfSQ=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    />
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- Chart.js for the graph -->
  </head>
  <body>
    <header>
      <div class="navbar">
        <div class="logo">
          <a href="#">
            <img src="logo.png" alt="IOB logo" />
          </a>
        </div>

        <!--Menu links-->
        <ul class="links">
          <li><a href="home.html">Health Dashboard</a></li>

          <!-- Mega Menu 
            <li class="mega-menu-container">
              <a href="#" class="mega-menu-link">Research Section</a>
              <div class="mega-menu">
                <h4>Research Section</h4>
                <a href="research.html#article1">Internet Of Bodies May Lead To Internet Of Brains by 2050</a>
                <a href="research.html#article2">Internet Of Bodies‚Äù - Turning the Body Into a Wire - Transhumanism & Nano-tech</a>
                <a href="research.html#NonVax420">NonVaxer420 Source</a>
                <a href="research.html#article4">Psinergy Source</a>
                <a href="research.html#video-summary">World Economic Forum</a>
              </div>
            </li>
        -->
          <!-- Mega Menu -->
          <li class="mega-menu-container">
            <a href="#" class="mega-menu-link">Features Section</a>
            <div class="mega-menu">
              <h4>Features Section</h4>
              <a href="citytracker.html">City Tracker</a>
              <a href="prediction.html">Prediction</a>
              <a href="healthsync.html">HealthSync Alert</a>
              <a href="mobiledemo.html">Multi-Location Map</a>
              <a href="humanlocation.html">Human Locator Map</a>
              <a href="animalvaccination.html">Animals Locator Map</a>
              <a href="iobmap.html">Internet of Bodies Map</a>
              <a href="location.html">Location Surveillance Map</a>
              <a href="livegps.html">Live ID Map</a>
            </div>
          </li>
        </ul>

        <a href="index.html" class="action_btn">Logout</a>
        <div class="toggle_btn">
          <i class="fa-solid fa-bars"></i>
        </div>
      </div>

      <div class="dropdown_menu">
        <ul>
          <li><a href="home.html">Health Dashboard</a></li>
          <li><a href="citytracker.html">CityBaron Tracker</a></li>
          <li><a href="prediction.html">Prediction</a></li>
          <li><a href="healthsync.html">HealthSync Alert</a></li>
          <li><a href="mobiledemo.html">Multi-Location Map</a></li>
          <li><a href="humanlocation.html">Human Locator Map</a></li>
          <li><a href="animalvaccination.html">Animals Locator Map</a></li>
          <li><a href="iobmap.html">Location Surveillance Map</a></li>
          <li><a href="location.html">Internet of Bodies Map</a></li>
          <li><a href="livegps.html">Live ID Map</a></li>
          <li><a href="index.html" class="action_btn">Logout</a></li>
        </ul>
      </div>
      <main>
        <!-- Health Dashboard Title in the Center -->
        <h1 class="dashboard-title">Health Dashboard</h1>

        <section id="virtual-doctor-simulation" class="feature-section">
          <h3>Virtual Doctor Visits Simulation</h3>
          <p>
            Experience how IoB devices can enable remote healthcare through
            real-time data analysis.
          </p>

          <!-- Ask a Question -->
          <div id="ask-question">
            <textarea
              id="user-question"
              placeholder="Ask a health-related question..."
            ></textarea>
            <button onclick="submitSimulationQuestion()">
              Submit Question
            </button>
            <div id="doctor-response">
              <p>The doctor's response will appear here.</p>
            </div>
          </div>
        </section>

        <section id="data" class="feature-section">
          <h3>Health Data</h3>
          <!-- Checkbox inside the health data section -->
          <div class="checkbox-container">
            <input type="checkbox" id="toggle-health-data" />
            <label for="toggle-health-data">Show Health Data</label>
          </div>
          <div id="health-content" style="display: none">
            <p>
              Analyze health trends over time. Access heart rate, steps, sleep
              patterns, and more with easy-to-read charts.
            </p>
            <p id="heartRate">Heart Rate: 0 BPM</p>
            <p id="steps">Steps: 0</p>
            <p id="sleep">Sleep: 8 hours</p>

            <!-- Canvas for health chart -->
            <canvas id="healthChart"></canvas>

            <!-- Canvas for heartbeat chart -->
            <h4>Live Heartbeat</h4>
            <canvas id="heartbeatChart" width="400" height="200"></canvas>

            <!-- Canvas for brainwave chart -->
            <h4>Live Brainwave Activity</h4>
            <canvas id="brainwaveChart" width="400" height="200"></canvas>

            <!-- Canvas for live glucose chart -->
            <h4>Live Glucose Levels</h4>
            <canvas id="glucoseChart" width="400" height="200"></canvas>

            <!-- Canvas for live stress level chart -->
            <h4>Live Stress Level</h4>
            <canvas id="stressChart" width="400" height="200"></canvas>
          </div>
        </section>

        <!--Vaccination-->
        <section id="vaccination-simulation" class="feature-section">
          <h3>Vaccination Simulation</h3>
          <p>
            Search for a vaccine to see its ingredients and possible side
            effects.
          </p>

          <div class="autocomplete">
            <input
              type="text"
              id="vaccineSearch"
              placeholder="Enter vaccine name..."
            />
            <div id="suggestion-box" class="suggestions"></div>
          </div>
          <button onclick="searchVaccine()">Search</button>

          <!-- Display Vaccine Info -->
          <div id="vaccineInfo"></div>
        </section>

        <!-- BMI -->
        <section id="bmi-calculator" class="feature-section">
          <h3>BMI Calculator</h3>
          <p>
            Enter your weight and height to calculate your BMI and check your
            health status.
          </p>
          <div id="bmi-inputs">
            <input
              type="number"
              id="bmi-weight"
              placeholder="Weight in kg"
              required
            />
            <input
              type="number"
              id="bmi-height"
              placeholder="Height in cm"
              required
            />
            <button onclick="calculateBMI()">Calculate BMI</button>
          </div>
          <div id="bmi-result" class="result">
            <!-- BMI result will be displayed here -->
          </div>
        </section>

        <!--Digital twin-->

        <section id="chatbot-section" class="feature-section">
          <h3>Chat with Digital Twin</h3>
          <div id="chat-box" class="chat-box">
            <!-- Messages will dynamically appear here -->
          </div>
          <div id="chat-input-container">
            <input
              type="text"
              id="chat-input"
              placeholder="Type your message..."
            />
            <button onclick="handleChatInput()">Send</button>
          </div>
        </section>

        <!--Breathing Exercise-->
        <div id="breathing-exercise">
          <h3>Breathing Exercise</h3>
          <div class="circle-container">
            <div class="circle" id="breathing-circle"></div>
            <p id="breathing-guide">Get Ready...</p>
          </div>
          <button onclick="startBreathingExercise()">
            Start Breathing Exercise
          </button>
        </div>

        <section id="tb-detection" class="feature-section">
          <h3>Detecting Tuberculosis with AI and a Smartphone</h3>
          <p>
            Leverage cutting-edge AI technology to detect tuberculosis using
            just your smartphone. This feature uses AI algorithms to analyze
            lung images for early and accurate detection of TB.
          </p>

          <!-- AI Detection Simulation -->
          <div class="tb-detection-container">
            <input
              type="file"
              id="upload-xray"
              accept="image/*"
              aria-label="Upload chest X-ray for TB detection"
            />
            <button onclick="analyzeXRay()">Analyze X-ray</button>
          </div>

          <!-- Display AI Analysis Result -->
          <div id="tb-analysis-result">
            <p>The result of the analysis will appear here.</p>
          </div>
        </section>

        <!-- Nutrition Tracker -->
        <section id="nutrition-tracker" class="feature-section">
          <h3>Nutrition Tracker</h3>
          <p>Log your daily food intake and monitor your nutritional goals.</p>
          <div id="nutrition-inputs">
            <input
              type="text"
              id="food-name"
              placeholder="Food name"
              required
            />
            <button onclick="fetchNutrition()">Get Nutrition Info</button>
          </div>
          <div id="nutrition-info" class="result">
            <h4>Nutrition Information</h4>
            <p id="nutrition-details"></p>
          </div>
          <div id="nutrition-log" class="result">
            <h4>Daily Food Log</h4>
            <ul id="food-log-list">
              <!-- Logged food items will appear here -->
            </ul>
          </div>
          <div id="nutrition-summary">
            <h4>Daily Nutritional Summary</h4>
            <p id="total-calories">Total Calories: 0 kcal</p>
            <p id="total-protein">Total Protein: 0 g</p>
            <p id="total-carbs">Total Carbohydrates: 0 g</p>
            <p id="total-fats">Total Fats: 0 g</p>
          </div>
          <div id="nutrition-warnings" class="result">
            <h4>Warnings</h4>
            <p id="calories-warning"></p>
            <p id="protein-warning"></p>
            <p id="carbs-warning"></p>
            <p id="fats-warning"></p>
          </div>
        </section>
      </main>
      <!-- JavaScript Section -->
      <script>
        // Initialize the state of health data section based on checkbox
        const toggleCheckbox = document.getElementById("toggle-health-data");
        const healthContent = document.getElementById("health-content");

        // Show health data if checkbox is already checked
        if (toggleCheckbox.checked) {
          healthContent.style.display = "block";
        }

        // Add event listener to toggle health data visibility
        toggleCheckbox.addEventListener("change", function () {
          if (toggleCheckbox.checked) {
            healthContent.style.display = "block"; // Show health data
          } else {
            healthContent.style.display = "none"; // Hide health data
          }
        });

        // 2. Update Health Data every 5 seconds
        // Simulate health data updates every 5 seconds, including stress level
        const updateHealthData = () => {
          const heartRate = Math.floor(Math.random() * (100 - 60 + 1)) + 60; // Simulating heart rate between 60 and 100
          const steps = Math.floor(Math.random() * 10000); // Simulating random steps
          const sleep = Math.floor(Math.random() * (8 - 4 + 1)) + 4; // Simulating hours of sleep
          const stress = Math.floor(Math.random() * 100); // Simulating stress level between 0% and 100%

          document.getElementById(
            "heartRate"
          ).textContent = `Heart Rate: ${heartRate} BPM`;
          document.getElementById("steps").textContent = `Steps: ${steps}`;
          document.getElementById(
            "sleep"
          ).textContent = `Sleep: ${sleep} hours`;

          // Update the health chart with new data, excluding glucose
          healthChart.data.datasets[0].data = [heartRate, steps, sleep, stress];
          healthChart.update();

          // Update the stress chart
          stressChart.data.datasets[0].data.shift();
          stressChart.data.datasets[0].data.push(stress);
          stressChart.update();
        };

        setInterval(updateHealthData, 5000);

        // Chart for stress level visualization
        const ctxStress = document
          .getElementById("stressChart")
          .getContext("2d");
        const stressChart = new Chart(ctxStress, {
          type: "line",
          data: {
            labels: Array.from({ length: 100 }, (_, i) => i),
            datasets: [
              {
                label: "Stress Level (%)",
                data: Array.from({ length: 100 }, () =>
                  Math.floor(Math.random() * 100)
                ),
                borderColor: "rgba(255, 99, 132, 1)",
                tension: 0.3,
                fill: false,
              },
            ],
          },
          options: {
            scales: {
              x: { display: false },
              y: { beginAtZero: true, suggestedMax: 100 },
            },
          },
        });
        // 3. Chart.js for health data visualization
        const ctx = document.getElementById("healthChart").getContext("2d");
        const healthChart = new Chart(ctx, {
          type: "bar",
          data: {
            labels: ["Heart Rate", "Steps", "Sleep"], // Only three labels
            datasets: [
              {
                label: "Health Data",
                data: [72, 5000, 7], // Placeholder data for heart rate, steps, and sleep
                backgroundColor: [
                  "rgba(255, 99, 132, 0.2)", // Heart Rate color
                  "rgba(54, 162, 235, 0.2)", // Steps color
                  "rgba(75, 192, 192, 0.2)", // Sleep color
                ],
                borderColor: [
                  "rgba(255, 99, 132, 1)", // Heart Rate border color
                  "rgba(54, 162, 235, 1)", // Steps border color
                  "rgba(75, 192, 192, 1)", // Sleep border color
                ],
                borderWidth: 1,
              },
            ],
          },
          options: {
            scales: {
              y: {
                beginAtZero: true,
              },
            },
          },
        });

        // 4. Chart.js for the heartbeat graph
        const ctxHeartbeat = document
          .getElementById("heartbeatChart")
          .getContext("2d");

        const heartbeatChart = new Chart(ctxHeartbeat, {
          type: "line",
          data: {
            labels: Array.from({ length: 100 }, (_, i) => i),
            datasets: [
              {
                label: "Heartbeat",
                data: Array.from(
                  { length: 100 },
                  (_, i) => Math.sin(i / 5) * (Math.random() * 0.5 + 1)
                ),
                borderColor: "rgba(255, 0, 0, 1)",
                tension: 0.3,
                fill: false,
              },
            ],
          },
          options: {
            scales: {
              x: { display: false },
              y: { beginAtZero: true },
            },
          },
        });

        // Function to update the heartbeat chart with new data every second
        const updateHeartbeatData = () => {
          heartbeatChart.data.datasets[0].data = Array.from(
            { length: 100 },
            (_, i) => Math.sin(i / 5) * (Math.random() * 0.5 + 1)
          );
          heartbeatChart.update();
        };

        setInterval(updateHeartbeatData, 1000);

        // 5. Chart.js for the brainwave graph
        const ctxBrainwave = document
          .getElementById("brainwaveChart")
          .getContext("2d");

        const brainwaveChart = new Chart(ctxBrainwave, {
          type: "line",
          data: {
            labels: Array.from({ length: 100 }, (_, i) => i),
            datasets: [
              {
                label: "Brainwave Activity",
                data: Array.from(
                  { length: 100 },
                  (_, i) => Math.sin(i / 10) * (Math.random() * 0.2 + 0.8)
                ),
                borderColor: "rgba(54, 162, 235, 1)",
                tension: 0.3,
                fill: false,
              },
            ],
          },
          options: {
            scales: {
              x: { display: false },
              y: { beginAtZero: true },
            },
          },
        });

        // Function to update brainwave data every second
        const updateBrainwaveData = () => {
          brainwaveChart.data.datasets[0].data = Array.from(
            { length: 100 },
            (_, i) => Math.sin(i / 10) * (Math.random() * 0.2 + 0.8)
          );
          brainwaveChart.update();
        };

        setInterval(updateBrainwaveData, 1000);

        // the function to handle the question submission
        function submitSimulationQuestion() {
          const question = document.getElementById("user-question").value;
          const doctorResponseDiv = document.getElementById("doctor-response");

          if (question.trim()) {
            // Simulate a doctor's response after a delay
            doctorResponseDiv.innerHTML =
              "<p>The doctor is reviewing your question...</p>";
            setTimeout(() => {
              doctorResponseDiv.innerHTML =
                "<p>The doctor says: Based on your data, you're in good health! Stay active and monitor your glucose levels.</p>";
            }, 2000); // Simulate a 2-second delay
          } else {
            doctorResponseDiv.innerHTML =
              "<p>Please enter a valid question.</p>";
          }
        }

        // 6. Chart.js for the live glucose chart
        const ctxGlucose = document
          .getElementById("glucoseChart")
          .getContext("2d");

        const glucoseChart = new Chart(ctxGlucose, {
          type: "line",
          data: {
            labels: Array.from({ length: 100 }, (_, i) => i),
            datasets: [
              {
                label: "Glucose Levels",
                data: Array.from(
                  { length: 100 },
                  () => Math.floor(Math.random() * (180 - 70 + 1)) + 70
                ),
                borderColor: "rgba(255, 159, 64, 1)",
                tension: 0.3,
                fill: false,
              },
            ],
          },
          options: {
            scales: {
              x: { display: false },
              y: {
                beginAtZero: true,
                suggestedMax: 200, // Customize max value if needed
              },
            },
          },
        });

        // Function to update glucose data every second
        const updateGlucoseData = () => {
          // Shift the existing data and add a new random glucose value
          glucoseChart.data.datasets[0].data.shift();
          glucoseChart.data.datasets[0].data.push(
            Math.floor(Math.random() * (180 - 70 + 1)) + 70
          );
          glucoseChart.update();
        };

        // Update the glucose chart data every 1 second
        setInterval(updateGlucoseData, 1000);

        // Array of vaccine data
        const vaccines = [
          {
            name: "Flu Vaccine",
            ingredients: [
              "Egg protein",
              "Formaldehyde",
              "Sucrose",
              "Antibiotics",
            ],
            common_side_effects: [
              "Soreness at injection site",
              "Mild fever",
              "Headache",
            ],
            severe_side_effects: ["Allergic reaction", "Difficulty breathing"],
          },
          {
            name: "COVID-19 Vaccine",
            ingredients: ["mRNA", "Lipids", "Salts", "Sucrose"],
            common_side_effects: [
              "Fever",
              "Fatigue",
              "Headache",
              "Muscle pain",
            ],
            severe_side_effects: ["Anaphylaxis", "Blood clots (rare)"],
          },
          {
            name: "Hepatitis B Vaccine",
            ingredients: [
              "Aluminum hydroxide",
              "Yeast protein",
              "Sodium chloride",
            ],
            common_side_effects: [
              "Pain at injection site",
              "Mild fever",
              "Fatigue",
            ],
            severe_side_effects: ["Severe allergic reaction (rare)"],
          },
          {
            name: "DTaP Vaccine",
            ingredients: [
              "Diphtheria toxoid",
              "Tetanus toxoid",
              "Acellular pertussis",
              "Aluminum phosphate",
            ],
            common_side_effects: [
              "Soreness at injection site",
              "Mild fever",
              "Irritability",
            ],
            severe_side_effects: ["Severe allergic reaction (very rare)"],
          },
          {
            name: "MMR Vaccine",
            ingredients: [
              "Live attenuated measles virus",
              "Live attenuated mumps virus",
              "Live attenuated rubella virus",
              "Gelatin",
            ],
            common_side_effects: ["Fever", "Mild rash", "Swollen glands"],
            severe_side_effects: [
              "Seizures due to fever (rare)",
              "Severe allergic reaction (very rare)",
            ],
          },
          {
            name: "Polio Vaccine (IPV)",
            ingredients: [
              "Inactivated poliovirus",
              "Formaldehyde",
              "2-Phenoxyethanol",
            ],
            common_side_effects: ["Pain at injection site", "Fatigue"],
            severe_side_effects: ["Severe allergic reaction (rare)"],
          },
          {
            name: "Hib Vaccine",
            ingredients: [
              "Haemophilus influenzae type b polysaccharide",
              "Aluminum sulfate",
            ],
            common_side_effects: [
              "Redness at injection site",
              "Fever",
              "Irritability",
            ],
            severe_side_effects: ["Severe allergic reaction (very rare)"],
          },
          {
            name: "Rotavirus Vaccine",
            ingredients: [
              "Live attenuated rotavirus",
              "Sucrose",
              "Dulbecco's Modified Eagle Medium (DMEM)",
            ],
            common_side_effects: ["Irritability", "Diarrhea", "Vomiting"],
            severe_side_effects: [
              "Intussusception (rare, intestinal blockage)",
            ],
          },
          {
            name: "Varicella Vaccine",
            ingredients: [
              "Live attenuated varicella-zoster virus",
              "Sucrose",
              "Gelatin",
            ],
            common_side_effects: [
              "Soreness at injection site",
              "Mild rash",
              "Fever",
            ],
            severe_side_effects: ["Severe allergic reaction (very rare)"],
          },
          {
            name: "Pneumococcal Vaccine (PCV13)",
            ingredients: [
              "Polysaccharide conjugated to diphtheria protein",
              "Aluminum phosphate",
            ],
            common_side_effects: [
              "Redness at injection site",
              "Fever",
              "Loss of appetite",
            ],
            severe_side_effects: ["Severe allergic reaction (very rare)"],
          },
          {
            name: "Tetanus Vaccine (Td)",
            ingredients: [
              "Tetanus toxoid",
              "Diphtheria toxoid",
              "Aluminum phosphate",
            ],
            common_side_effects: [
              "Pain at injection site",
              "Mild fever",
              "Fatigue",
            ],
            severe_side_effects: ["Severe allergic reaction (very rare)"],
          },
          {
            name: "Human Papillomavirus (HPV) Vaccine",
            ingredients: ["Recombinant HPV proteins", "Aluminum adjuvant"],
            common_side_effects: [
              "Pain at injection site",
              "Fever",
              "Dizziness",
              "Nausea",
            ],
            severe_side_effects: ["Severe allergic reaction (very rare)"],
          },
          {
            name: "Meningococcal Vaccine",
            ingredients: ["Meningococcal polysaccharide", "Diphtheria toxoid"],
            common_side_effects: [
              "Soreness at injection site",
              "Fatigue",
              "Headache",
            ],
            severe_side_effects: ["Severe allergic reaction (very rare)"],
          },
          {
            name: "Shingles Vaccine (Shingrix)",
            ingredients: ["Recombinant glycoprotein E", "AS01B adjuvant"],
            common_side_effects: [
              "Pain at injection site",
              "Muscle pain",
              "Fatigue",
            ],
            severe_side_effects: ["Severe allergic reaction (very rare)"],
          },
          {
            name: "Japanese Encephalitis Vaccine",
            ingredients: ["Inactivated JE virus", "Aluminum hydroxide"],
            common_side_effects: [
              "Pain at injection site",
              "Headache",
              "Muscle aches",
            ],
            severe_side_effects: ["Severe allergic reaction (very rare)"],
          },
          {
            name: "Yellow Fever Vaccine",
            ingredients: [
              "Live attenuated yellow fever virus",
              "Gelatin",
              "Lactose",
            ],
            common_side_effects: ["Fever", "Mild headache", "Muscle pain"],
            severe_side_effects: [
              "Severe allergic reaction (rare)",
              "Neurological effects (very rare)",
            ],
          },
        ];

        // Function to search for a vaccine and display its information
        function searchVaccine() {
          const searchQuery = document
            .getElementById("vaccineSearch")
            .value.toLowerCase();
          const vaccineInfoDiv = document.getElementById("vaccineInfo");

          // Filter vaccines with names that include the search query
          const matchedVaccines = vaccines.filter((v) =>
            v.name.toLowerCase().includes(searchQuery)
          );

          if (matchedVaccines.length > 0) {
            // Display all matched vaccines
            vaccineInfoDiv.innerHTML = matchedVaccines
              .map(
                (vaccine) => `
            <div>
                <h4>${vaccine.name}</h4>
                <p><strong>Ingredients:</strong> ${vaccine.ingredients.join(
                  ", "
                )}</p>
                <p><strong>Common Side Effects:</strong> ${vaccine.common_side_effects.join(
                  ", "
                )}</p>
                <p><strong>Severe Side Effects:</strong> ${vaccine.severe_side_effects.join(
                  ", "
                )}</p>
            </div>
        `
              )
              .join("");
          } else {
            vaccineInfoDiv.innerHTML =
              "<p>Vaccine not found. Please try another name.</p>";
          }
        }

        document
          .getElementById("vaccineSearch")
          .addEventListener("input", function () {
            const query = this.value.toLowerCase();
            const suggestionBox = document.getElementById("suggestion-box");
            suggestionBox.innerHTML = ""; // Clear previous suggestions

            if (query) {
              const matches = vaccines.filter((v) =>
                v.name.toLowerCase().includes(query)
              );
              if (matches.length > 0) {
                matches.forEach((match) => {
                  const suggestion = document.createElement("div");
                  suggestion.textContent = match.name;
                  suggestion.addEventListener("click", () => {
                    document.getElementById("vaccineSearch").value = match.name;
                    suggestionBox.style.display = "none";
                  });
                  suggestionBox.appendChild(suggestion);
                });
                suggestionBox.style.display = "block";
              } else {
                suggestionBox.style.display = "none";
              }
            } else {
              suggestionBox.style.display = "none";
            }
          });

        document
          .getElementById("vaccineSearch")
          .addEventListener("blur", function () {
            setTimeout(() => {
              document.getElementById("suggestion-box").style.display = "none"; // Hide suggestions when focus is lost
            }, 200);
          });

        //BMI
        function calculateBMI() {
          const weight = parseFloat(
            document.getElementById("bmi-weight").value
          );
          const height =
            parseFloat(document.getElementById("bmi-height").value) / 100; // Convert height to meters
          const resultDiv = document.getElementById("bmi-result");

          if (!weight || !height) {
            resultDiv.innerHTML =
              '<span style="color: red;">Please enter valid values for weight and height.</span>';
            return;
          }

          const bmi = (weight / (height * height)).toFixed(2);

          let status;
          if (bmi < 18.5) {
            status = "Unhealthy (Underweight)";
          } else if (bmi >= 18.5 && bmi <= 24.9) {
            status = "Healthy";
          } else {
            status = "Unhealthy (Overweight)";
          }

          resultDiv.innerHTML = `Your BMI is <strong>${bmi}</strong>: <span style="color: ${
            status === "Healthy" ? "green" : "red"
          };">${status}</span>`;
        }

        // Mood Tracker
        function suggestActivity() {
          const mood = document.getElementById("mood-select").value;
          const suggestion = document.getElementById("mood-suggestion");

          const activities = {
            happy: "Keep enjoying your day! Maybe share the joy with a friend.",
            stressed:
              "Take a few deep breaths or a short walk to clear your mind.",
            anxious:
              "Try a mindfulness exercise, like focusing on your breath for one minute.",
            calm: "Maintain this state with soft music or a cozy environment.",
          };

          suggestion.textContent =
            activities[mood] || "Choose a mood to get a suggestion.";
        }
        let chatHistory = []; // Stores the full conversation history

        // Triggered when the user sends a message
        function handleChatInput() {
          const chatInput = document.getElementById("chat-input");
          const userMessage = chatInput.value.trim();

          if (userMessage) {
            addChatMessage("user", userMessage); // Add user's message to the chat
            chatHistory.push({ sender: "user", message: userMessage }); // Store in chat history

            // Generate and display bot's response
            generateChatbotResponse(userMessage);

            chatInput.value = ""; // Clear input
          }
        }

        // Display messages in the chat box
        function addChatMessage(sender, message) {
          const chatBox = document.getElementById("chat-box");
          const chatMessage = document.createElement("div");
          chatMessage.className = `chat-message ${sender}`;
          chatMessage.textContent = message;

          chatBox.appendChild(chatMessage);
          chatBox.scrollTop = chatBox.scrollHeight; // Auto-scroll to the latest message
        }

        // Generate bot's response based on user's message
        function generateChatbotResponse(userMessage) {
          addTypingIndicator();

          // Simulate bot thinking for a moment
          setTimeout(() => {
            removeTypingIndicator();

            const mood = document.getElementById("mood-select").value;
            const response = getBotResponse(userMessage, mood);

            addChatMessage("bot", response); // Add bot's message to the chat
            chatHistory.push({ sender: "bot", message: response }); // Store in chat history
          }, 1000);
        }

        // Generate bot responses dynamically based on mood and context
        function getBotResponse(userMessage, mood) {
          // Example ongoing conversation context
          const moodPrompts = {
            happy: [
              "I'm glad you're feeling happy! What made your day special?",
              "That's great to hear! What's keeping you in such a good mood?",
              "Happiness is contagious! Tell me more about your day.",
            ],
            stressed: [
              "I'm here to help. What's been causing your stress lately?",
              "Take a deep breath. Let‚Äôs work through this together‚Äîwhat‚Äôs on your mind?",
              "Stress can be tough. Do you want to talk about what‚Äôs making you feel this way?",
            ],
            anxious: [
              "It‚Äôs okay to feel anxious sometimes. What‚Äôs making you feel this way?",
              "I‚Äôm here for you. Want to share what‚Äôs on your mind?",
              "Anxiety can be overwhelming. Let‚Äôs talk it out‚Äîwhat‚Äôs been bothering you?",
            ],
            calm: [
              "Calm is a great place to be. How can I help you stay in this state?",
              "That‚Äôs wonderful to hear. What‚Äôs been helping you feel so peaceful?",
              "Being calm is great for your well-being. What‚Äôs your secret?",
            ],
          };

          // Keyword-based response logic for dynamic conversations
          const keywords = {
            stress:
              "Stress is tough, but talking about it can help. Can I offer some relaxation tips?",
            happy:
              "I love that you‚Äôre happy! What‚Äôs keeping you in such a good mood?",
            sad: "I‚Äôm here for you. Want to share what‚Äôs making you feel this way?",
            tired: "Feeling tired is natural. Have you been sleeping well?",
            help: "I‚Äôm here to help! What do you need assistance with?",
          };

          // Match user input against keywords
          for (const keyword in keywords) {
            if (userMessage.toLowerCase().includes(keyword)) {
              return keywords[keyword];
            }
          }

          // Default mood-based response
          const randomMoodResponse =
            moodPrompts[mood]?.[
              Math.floor(Math.random() * moodPrompts[mood].length)
            ] || "Tell me more about how you're feeling.";
          return randomMoodResponse;
        }

        // Add typing indicator for a more natural feel
        function addTypingIndicator() {
          const chatBox = document.getElementById("chat-box");
          const typingIndicator = document.createElement("div");
          typingIndicator.id = "typing-indicator";
          typingIndicator.className = "chat-message bot";
          typingIndicator.textContent = "AI is typing...";
          chatBox.appendChild(typingIndicator);

          chatBox.scrollTop = chatBox.scrollHeight;
        }

        // Remove typing indicator
        function removeTypingIndicator() {
          const typingIndicator = document.getElementById("typing-indicator");
          if (typingIndicator) {
            typingIndicator.remove();
          }
        }

        //Breathing Exercise
        function startBreathingExercise() {
          const guide = document.getElementById("breathing-guide");
          const circle = document.getElementById("breathing-circle");

          let state = "Inhale"; // Initial state
          let cycleCount = 0; // Count how many cycles the user has completed

          const updateState = () => {
            if (state === "Inhale") {
              guide.textContent = "Hold";
              circle.style.transform = "scale(1.2)"; // Expand slightly for "Hold"
              circle.style.borderColor = "#ffeb3b"; // Yellow for hold
              state = "Hold";

              setTimeout(updateState, 4000); // After 4 seconds, transition to "Exhale"
            } else if (state === "Hold") {
              guide.textContent = "Exhale";
              circle.style.transform = "scale(0.8)"; // Shrink for "Exhale"
              circle.style.borderColor = "#f44336"; // Red for exhale
              state = "Exhale";

              setTimeout(updateState, 4000); // After 4 seconds, transition to "Inhale"
            } else if (state === "Exhale") {
              guide.textContent = "Inhale";
              circle.style.transform = "scale(1)"; // Return to original size for "Inhale"
              circle.style.borderColor = "#4caf50"; // Green for inhale
              state = "Inhale";

              cycleCount++; // Increment cycle count
              if (cycleCount === 3) {
                // Trigger the message after 3 full cycles
                showEncouragementMessage();
                return; // Stop the breathing cycle until the user decides to continue
              }

              setTimeout(updateState, 4000); // After 4 seconds, transition to "Hold"
            }
          };

          // Start the initial "Inhale" state
          guide.textContent = "Inhale";
          circle.style.transform = "scale(1)"; // Reset scale
          circle.style.borderColor = "#4caf50"; // Green for inhale
          setTimeout(updateState, 4000); // Begin the cycle
        }

        function showEncouragementMessage() {
          const userResponse = confirm(
            "You're getting better! Would you like to continue?"
          );

          if (userResponse) {
            alert("Great! Let's keep going.");
            startBreathingExercise(); // Restart the breathing exercise
          } else {
            alert("That's okay! Take a break and come back when you're ready.");
          }
        }

        // Simulate TB detection using uploaded X-ray
        function analyzeXRay() {
          const uploadXRay = document.getElementById("upload-xray");
          const tbResultDiv = document.getElementById("tb-analysis-result");

          if (uploadXRay.files.length > 0) {
            const fileName = uploadXRay.files[0].name;

            // Simulate analysis delay
            tbResultDiv.innerHTML = `<p>Analyzing the X-ray image "${fileName}"...</p>`;
            setTimeout(() => {
              // Simulate random TB detection result
              const hasTB = Math.random() < 0.3; // 30% chance of TB detected
              tbResultDiv.innerHTML = hasTB
                ? `<p style="color: red;">The AI detected signs of tuberculosis. Please consult a medical professional immediately.</p>`
                : `<p style="color: green;">No signs of tuberculosis detected. Keep monitoring your health!</p>`;
            }, 2000); // 2-second delay to simulate analysis
          } else {
            tbResultDiv.innerHTML = `<p style="color: red;">Please upload a chest X-ray image for analysis.</p>`;
          }
        }

        //Nutrition Tracker

        const API_KEY = "4981edf48bb157fb32d9a8d4b7378f18";
        const APP_ID = "b377fc47";
        const API_URL = "https://trackapi.nutritionix.com/v2/natural/nutrients";

        async function fetchNutrition() {
          const foodName = document.getElementById("food-name").value;
          const response = await fetch(API_URL, {
            method: "POST",
            headers: {
              "Content-Type": "application/json",
              "x-app-id": APP_ID,
              "x-app-key": API_KEY,
            },
            body: JSON.stringify({
              query: foodName,
            }),
          });

          const data = await response.json();
          displayNutritionInfo(data);
        }

        function displayNutritionInfo(data) {
          const nutritionDetails = document.getElementById("nutrition-details");

          if (data.foods && data.foods.length > 0) {
            const food = data.foods[0];
            nutritionDetails.textContent = `
        Food: ${food.food_name}
        Calories: ${food.nf_calories} kcal
        Protein: ${food.nf_protein} g
        Carbohydrates: ${food.nf_total_carbohydrate} g
        Fats: ${food.nf_total_fat} g
        Fiber: ${food.nf_dietary_fiber} g
      `;
          } else {
            nutritionDetails.textContent = "No nutritional information found.";
          }
        }
      </script>

      <script>
        let lastScrollY = window.scrollY;
        const navbar = document.querySelector(".navbar");

        window.addEventListener("scroll", () => {
          if (window.scrollY > lastScrollY) {
            // Scrolling down - hide navbar
            navbar.style.transform = "translateY(-100%)";
          } else {
            // Scrolling up - show navbar
            navbar.style.transform = "translateY(0)";
          }
          lastScrollY = window.scrollY;
        });
      </script>

      <script>
        const toggleBtn = document.querySelector(".toggle_btn");
        const toggleBtnIcon = document.querySelector(".toggle_btn i");
        const dropDownMenu = document.querySelector(".dropdown_menu");

        toggleBtn.onclick = function () {
          dropDownMenu.classList.toggle("open");
          const isOpen = dropDownMenu.classList.contains("open");

          toggleBtnIcon.classList = isOpen
            ? "fa-solid fa-xmark"
            : "fa-solid fa-bars";
        };
      </script>

      <!-- Footer Section -->
      <footer>
        <div class="footer__bottom">
          <p>Internet of Bodies &copy; Accountable Infrastructure 2024</p>
        </div>
      </footer>
    </header>
  </body>
</html>
